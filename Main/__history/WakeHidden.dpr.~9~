program WakeHidden;

uses
  Vcl.Forms,  IniFiles, System.IOUtils, System.SysUtils,


  WakeHiddenU in 'WakeHiddenU.pas' {FormWake},
  ShwFilesU in 'ShwFilesU.pas' {ShwFiles},
  FormToastU in 'FormToastU.pas' {FormToastF};

{$R *.res}
function GetShowInTaskbarSetting: Boolean;
var
  ini: TIniFile;
begin
  ini := TIniFile.Create(TPath.Combine(GetEnvironmentVariable('LOCALAPPDATA'), 'HiddenScheduler\settings.ini'));
  try
    Result := ini.ReadBool('Options', 'ShowInTaskbar', True); // Default: True
  finally
    ini.Free;
  end;
end;

begin
  Application.Initialize;
  Application.MainFormOnTaskbar := GetShowInTaskbarSetting;
  Application.CreateForm(TShwFiles, ShwFiles);
  Application.CreateForm(TFormWake, FormWake);
  Application.CreateForm(TFormToastF, FormToastF);
  Application.Run;
end.
